<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<title>D3: Setting the content of paragraphs from data</title>
		<script type="text/javascript" src="../d3.js"></script>
	</head>
	<body>
        <div id="updatableChart"></div>
        <script type="text/javascript">

        /**/
        /* Define the Chart module */
        /**/
        function chartModule() {
            var text = "None";
            
            /* define Ctor */
            function chart(selection) {

                // loop through all selections
                console.log("selection = ");
                console.log(selection);
                selection.each(function (data) {
                    
                    // this is one element in selection object
                    console.log("this = ");
                    console.log(this);

                    // data is what was bound to datum 
                    console.log("data = ");
                    console.log(data);

                    // select, bind, enter, append
                    var dom = d3.select(this)
                                .selectAll("p")
                                .data(data)
                                .enter()
                                .append("p")
                                .html((d) => {return "Paragraph " + d});
                })
            }
            
            /* Define Setters and Getters */
            chart.text = function(_) {
                if (!arguments.length) return text;
                text = _;
                return chart;
            }

            /* Return closure */
            return chart;
        }

        /**/
        /* Create chart object */
        /**/
        var dataset = [ 5, 10, 15, 20, 25 ];
        var updatableChart = chartModule().text("Creating new chart..");
        console.log(updatableChart.text());

        /**/
        /* select, bind, call */
        /**/
        d3.select('div#updatableChart')
            .datum(dataset)
            .call(updatableChart);

        /* Finally */
        console.log("Done!");

		</script>
	</body>
</html>